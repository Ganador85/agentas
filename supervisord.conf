[supervisord]
nodaemon=true

[program:xvfb]
command=/usr/bin/Xvfb :99 -screen 0 1280x800x24 -ac +extension RANDR
autorestart=true
priority=10
startsecs=2

[program:fluxbox]
command=/usr/bin/fluxbox
environment=DISPLAY=":99"
autorestart=true
priority=20
startsecs=2

[program:x11vnc]
command=/usr/bin/x11vnc -display :99 -rfbport 5900 -forever -shared -nopw -repeat -xkb
autorestart=true
priority=30
startsecs=2

[program:novnc]
command=/usr/bin/websockify --web=/usr/share/novnc --heartbeat=30 7900 localhost:5900
autorestart=true
priority=40
startsecs=2

; IPv6 → IPv4 tiltas: iš :::9222 į 127.0.0.1:9223
[program:cdp6proxy]
command=/usr/bin/socat -dd TCP6-LISTEN:9222,reuseaddr,fork TCP4:127.0.0.1:9223
autorestart=true
priority=45
startsecs=2

; Chrome su CDP lokaliai (127.0.0.1:9223) ir leidžiam ne localhost Host antraštes
[program:chrome]
command=/bin/sh -lc 'sleep 2; rm -f /data/Singleton* /data/SingletonLock*; exec /usr/bin/google-chrome-stable --no-first-run --no-default-browser-check --no-sandbox --disable-gpu --disable-dev-shm-usage --disable-features=AutomationControlled,Translate --remote-debugging-address=127.0.0.1 --remote-debugging-port=9223 --remote-allow-origins=* --remote-allow-hosts=* --no-proxy-server --proxy-bypass-list=* --user-data-dir=/data --lang=lt --start-maximized --window-size=1280,800 about:blank'
environment=DISPLAY=":99",LANG="lt_LT.UTF-8",LC_ALL="lt_LT.UTF-8",HTTP_PROXY="",HTTPS_PROXY="",NO_PROXY="*"
autorestart=true
priority=50
startsecs=5
